{"paragraphs":[{"text":"case class games(GameDate: String, \nDayName: String, \nWinningSchool: String, \nWinningPoints: Int,\nGameLocation: String, \nLoserSchool: String, \nLoserPoints: Integer)\n\nval games = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/games/games.csv\")\ngames.createOrReplaceTempView(\"games\")\n\nval standings = spark.read.format(\"csv\").option(\"header\", true).option(\"inferSchema\", true).load(\"/user/maria_dev/final/standings/standings.csv\")\nstandings.createOrReplaceTempView(\"standings\")","user":"anonymous","dateUpdated":"2020-12-14T03:05:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class games\ngames: org.apache.spark.sql.DataFrame = [date_game: timestamp, day_name: string ... 5 more fields]\nstandings: org.apache.spark.sql.DataFrame = [yr: int, school_name: string ... 12 more fields]\n"}]},"apps":[],"jobName":"paragraph_1607887859559_883291003","id":"20201213-193059_885076966","dateCreated":"2020-12-13T19:30:59+0000","dateStarted":"2020-12-14T03:05:02+0000","dateFinished":"2020-12-14T03:05:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:365"},{"text":"spark.sqlContext.sql(\"select winner_school_name, month, day, sum(winner_points) as totalpoints, count(*) as gamesplayed from (select winner_school_name, day(date_game) as day, month(date_game) as month, winner_points from games union all select loser_school_name, day(date_game), month(date_game), loser_points from games) answer group by winner_school_name, month,day order by 4 desc\").show()","user":"anonymous","dateUpdated":"2020-12-13T20:38:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-----+---+-----------+-----------+\n| winner_school_name|month|day|totalpoints|gamesplayed|\n+-------------------+-----+---+-----------+-----------+\n|           Michigan|   10|  8|        876|         21|\n|           Michigan|    1|  1|        830|         34|\n|            Alabama|    1|  1|        761|         34|\n|Southern California|    1|  1|        686|         31|\n|           Oklahoma|   10|  4|        685|         15|\n|           Michigan|   10| 12|        664|         20|\n|            Georgia|    1|  1|        656|         27|\n|           Nebraska|   10|  7|        632|         16|\n|           Nebraska|   11| 10|        614|         18|\n|               Utah|   11|  3|        611|         17|\n|          Princeton|   10| 29|        602|         17|\n|       Georgia Tech|   11| 10|        594|         20|\n|           Michigan|   10| 25|        593|         19|\n|           Oklahoma|    1|  1|        592|         24|\n|            Georgia|   10|  4|        590|         15|\n|            Alabama|    9| 30|        576|         17|\n|           Oklahoma|   11|  3|        575|         18|\n|           Michigan|   10|  4|        569|         19|\n|           Oklahoma|   10| 11|        562|         17|\n|            Alabama|   10|  7|        555|         17|\n+-------------------+-----+---+-----------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1607888441329_-614308247","id":"20201213-194041_346216506","dateCreated":"2020-12-13T19:40:41+0000","dateStarted":"2020-12-13T20:38:46+0000","dateFinished":"2020-12-13T20:38:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:366"},{"text":"spark.sqlContext.sql(\"select winner_school_name, count(*) as totalopponents from (select distinct winner_school_name, loser_school_name from games join standings wins on games.winner_school_name = wins.school_name and wins.yr = 2019 join standings loss on games.loser_school_name = loss.school_name and loss.yr = 2019  union select distinct loser_school_name, winner_school_name from games join standings wins on games.winner_school_name = wins.school_name and wins.yr = 2019 join standings loss on games.loser_school_name = loss.school_name and loss.yr = 2019) answer group by winner_school_name order by 2 desc\").show()","user":"anonymous","dateUpdated":"2020-12-14T03:05:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------+\n|winner_school_name|totalopponents|\n+------------------+--------------+\n|         Tennessee|            99|\n|           Florida|            97|\n|          Missouri|            95|\n|              Army|            93|\n|        Miami (FL)|            93|\n|          Nebraska|            92|\n|   Texas Christian|            91|\n|              Rice|            90|\n|          Oklahoma|            90|\n|Southern Methodist|            90|\n|        Ohio State|            90|\n|      Kansas State|            89|\n|        Penn State|            89|\n|            Kansas|            89|\n|     West Virginia|            88|\n|           Georgia|            88|\n|         Wisconsin|            88|\n|          Michigan|            87|\n|           Houston|            87|\n|        Cincinnati|            87|\n+------------------+--------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1607888524189_-1963699261","id":"20201213-194204_883218124","dateCreated":"2020-12-13T19:42:04+0000","dateStarted":"2020-12-14T03:05:10+0000","dateFinished":"2020-12-14T03:05:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:367"},{"text":"spark.sqlContext.sql(\"select winner_school_name, loser_school_name, count(*) as ConferencesPlayed from ( select distinct winner_school_name, loser_school_name, wins.confname from games cfg join standings wins on cfg.winner_school_name = wins.school_name and year(cfg.date_game) = wins.yr join standings loss on cfg.loser_school_name = loss.school_name and year(cfg.date_game) = loss.yr where wins.confname = loss.confname union select distinct loser_school_name, winner_school_name,  wins.confname from games cfg join standings wins on cfg.winner_school_name = wins.school_name and year(cfg.date_game) = wins.yr join standings loss on cfg.loser_school_name = loss.school_name and year(cfg.date_game) = loss.yr where wins.confname = loss.confname ) answer group by winner_school_name, loser_school_name order by 3 desc\").show()","user":"anonymous","dateUpdated":"2020-12-14T03:05:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+-----------------+-----------------+\n|winner_school_name|loser_school_name|ConferencesPlayed|\n+------------------+-----------------+-----------------+\n|            Kansas|         Missouri|                6|\n|            Kansas|         Nebraska|                6|\n|              Utah|          Wyoming|                6|\n|          Nebraska|       Iowa State|                6|\n|      Oregon State| Washington State|                6|\n|            Kansas|         Oklahoma|                6|\n|            Oregon|     Oregon State|                6|\n|          Missouri|           Kansas|                6|\n|    Colorado State|             Utah|                6|\n|          Nebraska|           Kansas|                6|\n|  Washington State|           Oregon|                6|\n|          Nebraska|         Missouri|                6|\n|              Utah|   Colorado State|                6|\n|            Oregon| Washington State|                6|\n|  Washington State|     Oregon State|                6|\n|          Oklahoma|           Kansas|                6|\n|          Missouri|         Nebraska|                6|\n|           Wyoming|             Utah|                6|\n|    Colorado State|          Wyoming|                6|\n|      Oregon State|           Oregon|                6|\n+------------------+-----------------+-----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1607889550084_503369218","id":"20201213-195910_32409391","dateCreated":"2020-12-13T19:59:10+0000","dateStarted":"2020-12-14T03:05:49+0000","dateFinished":"2020-12-14T03:06:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:368"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607891900121_328276175","id":"20201213-203820_1444658638","dateCreated":"2020-12-13T20:38:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:369","text":"spark.sqlContext.sql(\"with dr as ( select cfg.winner_school_name, cfg.loser_school_name, cfg.date_game, max(maxloss.date_game) as recentloss from games cfg left join games maxloss on cfg.winner_school_name = maxloss.loser_school_name and cfg.loser_school_name = maxloss.winner_school_name and cfg.date_game > maxloss.date_game and maxloss.loser_points != maxloss.winner_points group by cfg.winner_school_name, cfg.loser_school_name, cfg.date_game ),  streaks as ( select dr.winner_school_name, dr.loser_school_name, dr.date_game, count(*) as streak from dr  join games cfg on dr.winner_school_name = cfg.winner_school_name and dr.loser_school_name = cfg.loser_school_name and cfg.date_game between dr.recentloss and  dr.date_game where cfg.loser_points != cfg.winner_points group by dr.winner_school_name, dr.loser_school_name, dr.date_game ), beststreaks as ( select winner_school_name, loser_school_name, max(streak) as beststreak from streaks group by winner_school_name, loser_school_name) select beststreaks.*, streaks.date_game, wins.confname from beststreaks  join streaks on beststreaks.winner_school_name = streaks.winner_school_name and beststreaks.loser_school_name = streaks.loser_school_name and streaks.streak = beststreaks.beststreak join standings wins on beststreaks.winner_school_name = wins.school_name and year(streaks.date_game) = wins.yr join standings loss on beststreaks.loser_school_name = loss.school_name and year(streaks.date_game) = loss.yr where wins.confname = loss.confname  and streaks.date_game > '2000-01-01' order by 3 desc\").show()","dateUpdated":"2020-12-14T03:06:32+0000","dateFinished":"2020-12-14T03:06:57+0000","dateStarted":"2020-12-14T03:06:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+-----------------+----------+-------------------+--------+\n|winner_school_name|loser_school_name|beststreak|          date_game|confname|\n+------------------+-----------------+----------+-------------------+--------+\n|        Notre Dame|             Navy|        43|2006-10-28 00:00:00|     Ind|\n|          Nebraska|           Kansas|        36|2004-10-02 00:00:00|  Big 12|\n|           Florida|         Kentucky|        31|2017-09-23 00:00:00|     SEC|\n|         Tennessee|         Kentucky|        26|2010-11-27 00:00:00|     SEC|\n|        Ohio State|     Northwestern|        24|2003-09-27 00:00:00| Big Ten|\n|          Nebraska|         Missouri|        24|2002-10-12 00:00:00|  Big 12|\n|          Michigan|          Indiana|        24|2019-11-23 00:00:00| Big Ten|\n|         Tennessee|       Vanderbilt|        22|2004-11-20 00:00:00|     SEC|\n|           Alabama|       Vanderbilt|        22|2017-09-23 00:00:00|     SEC|\n|           Florida|       Vanderbilt|        22|2012-10-13 00:00:00|     SEC|\n|        Washington|       California|        19|2001-09-29 00:00:00|  Pac-10|\n|          Virginia|      Wake Forest|        17|2000-09-30 00:00:00|     ACC|\n|         Texas A&M|           Baylor|        17|2003-10-11 00:00:00|  Big 12|\n|     West Virginia|          Rutgers|        17|2011-10-29 00:00:00|Big East|\n|          Syracuse|           Temple|        16|2001-10-20 00:00:00|Big East|\n|          Michigan|        Minnesota|        16|2004-10-09 00:00:00| Big Ten|\n|          Nebraska|        Minnesota|        16|2012-11-17 00:00:00| Big Ten|\n|        Texas Tech|           Baylor|        15|2010-10-09 00:00:00|  Big 12|\n|        Notre Dame|             Army|        15|2016-11-12 00:00:00|     Ind|\n|          Oklahoma|           Kansas|        15|2019-10-05 00:00:00|  Big 12|\n+------------------+-----------------+----------+-------------------+--------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1607915051543_1119704442","id":"20201214-030411_1229715931","dateCreated":"2020-12-14T03:04:11+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:798"}],"name":"FinalProjectCFB","id":"2FUB1SAX9","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}